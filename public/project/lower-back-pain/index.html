<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.7.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Steven Golovkine">

  
  
  
    
  
  <meta name="description" content="Lower back pain can be caused by a variety of problems. How identify an abnormal or normal person using collected physical spine details and data?">

  
  <link rel="alternate" hreflang="en-us" href="/project/lower-back-pain/">

  


  
  
  
  <meta name="theme-color" content="#795548">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cutive+Mono%7CLora:400,700%7CRoboto:400,700&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu1d2d3b6ebbfe3e5882ce5725380dc208_3894_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu1d2d3b6ebbfe3e5882ce5725380dc208_3894_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/project/lower-back-pain/">

  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@StevenGolovkine">
  <meta property="twitter:creator" content="@StevenGolovkine">
  
  <meta property="og:site_name" content="TwentyFourSecs">
  <meta property="og:url" content="/project/lower-back-pain/">
  <meta property="og:title" content="Lower Back Pain | TwentyFourSecs">
  <meta property="og:description" content="Lower back pain can be caused by a variety of problems. How identify an abnormal or normal person using collected physical spine details and data?"><meta property="og:image" content="/project/lower-back-pain/featured.jpg">
  <meta property="twitter:image" content="/project/lower-back-pain/featured.jpg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-01-05T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2019-01-05T00:00:00&#43;00:00">
  

  


    











<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/project/lower-back-pain/"
  },
  "headline": "Lower Back Pain",
  
  "image": [
    "/project/lower-back-pain/featured.jpg"
  ],
  
  "datePublished": "2019-01-05T00:00:00Z",
  "dateModified": "2019-01-05T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Steven Golovkine"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "TwentyFourSecs",
    "logo": {
      "@type": "ImageObject",
      "url": "img//"
    }
  },
  "description": "Lower back pain can be caused by a variety of problems. How identify an abnormal or normal person using collected physical spine details and data?"
}
</script>

  

  


  


  





  <title>Lower Back Pain | TwentyFourSecs</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">TwentyFourSecs</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">TwentyFourSecs</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item">
        <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article article-project">

  




















  
  
    
  


<div class="article-container pt-3">
  <h1>Lower Back Pain</h1>

  

  


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Jan 5, 2019
  </span>
  

  

  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/python/">Python</a>, <a href="/categories/machine-learning/">Machine Learning</a></span>
  

</div>

  














</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 540px;">
  <div style="position: relative">
    <img src="/project/lower-back-pain/featured_huf09fc8fb57c9d5284b40ddf6f0b1d6ee_490665_720x0_resize_q90_lanczos.jpg" alt="" class="featured-image">
    <span class="article-header-caption">Photo by Mariolh from Pixabay</span>
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      

<div id="TOC">
<ul>
<li><a href="#context">Context</a></li>
<li><a href="#question">Question</a></li>
<li><a href="#exploration-of-the-data">Exploration of the data</a></li>
<li><a href="#subset-features-selection">Subset features selection</a></li>
<li><a href="#model-construction">Model construction</a></li>
</ul>
</div>

<p>This dataset is provided by sammy123 on <a href="https://www.kaggle.com/sammy123/lower-back-pain-symptoms-dataset">Kaggle</a>. My study and the complete code are on a Kaggle <a href="https://www.kaggle.com/stevengolo/lower-back-pain-syndrom">kernel</a>.</p>
<div id="context" class="section level1">
<h1>Context</h1>
<p>Lower back pain can be caused by a variety of problems with any parts of the complex, interconnected network of spinal muscles, nerves, bones, discs or tendons in the lumbar spines. Typical sources of low back pain include:</p>
<ul>
<li>The large nerve roots in the low back that go to the legs may be irritated.</li>
<li>The smaller nerves that supply the low back may be irritated.</li>
<li>The large paired lower back muscles (erector spinae) may be strained.</li>
<li>The bones, ligaments or joints may be damaged.</li>
<li>An intervertebral disc may be degenerating.</li>
</ul>
<p>An irritation or problem with any of these structures can cause lower back pain and/or pain that radiates or is referred to other parts of the body. Many lower back problems can also cause back muscle spasms, which do not sound like much but can cause severe pain and disability.</p>
<p>While lower back pain is extremely common, the symptoms and severity of lower back pain vary greatly. A simple lower back muscle strain might be excruciating enough to necessitate an emergency room visit, while a degenerating disc might cause only mild, intermittent discomfort.</p>
</div>
<div id="question" class="section level1">
<h1>Question</h1>
<p>How identify an abnormal or normal person using collected physical spine details and data?</p>
<pre class="python"><code># Import the data
data = pd.read_csv(&quot;Dataset_spine.csv&quot;, decimal=&#39;.&#39;, sep=&#39;,&#39;, header=0)
data = data.drop(&#39;Unnamed: 13&#39;, 1)
data.columns = [&#39;pelvic_incidence&#39;, &#39;pelvic_tilt&#39;,
                &#39;lumbar_lordosis_angle&#39;, &#39;sacral_slope&#39;,
                &#39;pelvic_radius&#39;, &#39;degree_spondylolisthesis&#39;,
                &#39;pelvic_slope&#39;, &#39;direct_tilt&#39;,
                &#39;thoracic_slope&#39;, &#39;cervical_tilt&#39;,
                &#39;sacrum_angle&#39;, &#39;scoliosis_slope&#39;,
                &#39;class&#39;]

data.head()</code></pre>
<div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
Pelvic Incidence
</th>
<th>
Pelvic Tilt
</th>
<th>
Lumbar Lordosis Angle
</th>
<th>
Sacral Slope
</th>
<th>
Pelvic Radius
</th>
<th>
Degree Spondylolisthesis
</th>
<th>
Pelvic Slope
</th>
<th>
Direct Tilt
</th>
<th>
Thoracic Slope
</th>
<th>
Cervical Tilt
</th>
<th>
Sacrum Angle
</th>
<th>
Scoliosis Slope
</th>
<th>
Class
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
63.027818
</td>
<td>
22.552586
</td>
<td>
39.609117
</td>
<td>
40.475232
</td>
<td>
98.672917
</td>
<td>
-0.254400
</td>
<td>
0.744503
</td>
<td>
12.5661
</td>
<td>
14.5386
</td>
<td>
15.30468
</td>
<td>
-28.658501
</td>
<td>
43.5123
</td>
<td>
Abnormal
</td>
</tr>
<tr>
<td>
39.056951
</td>
<td>
10.060991
</td>
<td>
25.015378
</td>
<td>
28.995960
</td>
<td>
114.405425
</td>
<td>
4.564259
</td>
<td>
0.415186
</td>
<td>
12.8874
</td>
<td>
17.5323
</td>
<td>
16.78486
</td>
<td>
-25.530607
</td>
<td>
16.1102
</td>
<td>
Abnormal
</td>
</tr>
<tr>
<td>
68.832021
</td>
<td>
22.218482
</td>
<td>
50.092194
</td>
<td>
46.613539
</td>
<td>
105.985135
</td>
<td>
-3.530317
</td>
<td>
0.474889
</td>
<td>
26.8343
</td>
<td>
17.4861
</td>
<td>
16.65897
</td>
<td>
-29.031888
</td>
<td>
19.2221
</td>
<td>
Abnormal
</td>
</tr>
<tr>
<td>
69.297008
</td>
<td>
24.652878
</td>
<td>
44.311238
</td>
<td>
44.644130
</td>
<td>
101.868495
</td>
<td>
11.211523
</td>
<td>
0.369345
</td>
<td>
23.5603
</td>
<td>
12.7074
</td>
<td>
11.42447
</td>
<td>
-30.470246
</td>
<td>
18.8329
</td>
<td>
Abnormal
</td>
</tr>
<tr>
<td>
49.712859
</td>
<td>
9.652075
</td>
<td>
28.317406
</td>
<td>
40.060784
</td>
<td>
108.168725
</td>
<td>
7.918501
</td>
<td>
0.543360
</td>
<td>
35.4940
</td>
<td>
15.9546
</td>
<td>
8.87237
</td>
<td>
-16.378376
</td>
<td>
24.9171
</td>
<td>
Abnormal
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="exploration-of-the-data" class="section level1">
<h1>Exploration of the data</h1>
<ul>
<li>Let’s check if there are some missing values in this dataset.</li>
</ul>
<pre class="python"><code>data.info()</code></pre>
<pre><code>    &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
    RangeIndex: 310 entries, 0 to 309
    Data columns (total 13 columns):
    pelvic_incidence            310 non-null float64
    pelvic_tilt                 310 non-null float64
    lumbar_lordosis_angle       310 non-null float64
    sacral_slope                310 non-null float64
    pelvic_radius               310 non-null float64
    degree_spondylolisthesis    310 non-null float64
    pelvic_slope                310 non-null float64
    direct_tilt                 310 non-null float64
    thoracic_slope              310 non-null float64
    cervical_tilt               310 non-null float64
    sacrum_angle                310 non-null float64
    scoliosis_slope             310 non-null float64
    class                       310 non-null object
    dtypes: float64(12), object(1)
    memory usage: 31.6+ KB</code></pre>
<ul>
<li>Compute some basic statistics about the data.</li>
</ul>
<pre class="python"><code>data.describe()</code></pre>
<div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
Pelvic Incidence
</th>
<th>
Pelvic Tilt
</th>
<th>
Lumbar Lordosis Angle
</th>
<th>
Sacral Slope
</th>
<th>
Pelvic Radius
</th>
<th>
Degree Spondylolisthesis
</th>
<th>
Pelvic Slope
</th>
<th>
Direct Tilt
</th>
<th>
Thoracic Slope
</th>
<th>
Cervical Tilt
</th>
<th>
Sacrum Angle
</th>
<th>
Scoliosis Slope
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
Count
</th>
<td>
310.000000
</td>
<td>
310.000000
</td>
<td>
310.000000
</td>
<td>
310.000000
</td>
<td>
310.000000
</td>
<td>
310.000000
</td>
<td>
310.000000
</td>
<td>
310.000000
</td>
<td>
310.000000
</td>
<td>
310.000000
</td>
<td>
310.000000
</td>
<td>
310.000000
</td>
</tr>
<tr>
<th>
Mean
</th>
<td>
60.496653
</td>
<td>
17.542822
</td>
<td>
51.930930
</td>
<td>
42.953831
</td>
<td>
117.920655
</td>
<td>
26.296694
</td>
<td>
0.472979
</td>
<td>
21.321526
</td>
<td>
13.064511
</td>
<td>
11.933317
</td>
<td>
-14.053139
</td>
<td>
25.645981
</td>
</tr>
<tr>
<th>
Std
</th>
<td>
17.236520
</td>
<td>
10.008330
</td>
<td>
18.554064
</td>
<td>
13.423102
</td>
<td>
13.317377
</td>
<td>
37.559027
</td>
<td>
0.285787
</td>
<td>
8.639423
</td>
<td>
3.399713
</td>
<td>
2.893265
</td>
<td>
12.225582
</td>
<td>
10.450558
</td>
</tr>
<tr>
<th>
Min
</th>
<td>
26.147921
</td>
<td>
-6.554948
</td>
<td>
14.000000
</td>
<td>
13.366931
</td>
<td>
70.082575
</td>
<td>
-11.058179
</td>
<td>
0.003220
</td>
<td>
7.027000
</td>
<td>
7.037800
</td>
<td>
7.030600
</td>
<td>
-35.287375
</td>
<td>
7.007900
</td>
</tr>
<tr>
<th>
25%
</th>
<td>
46.430294
</td>
<td>
10.667069
</td>
<td>
37.000000
</td>
<td>
33.347122
</td>
<td>
110.709196
</td>
<td>
1.603727
</td>
<td>
0.224367
</td>
<td>
13.054400
</td>
<td>
10.417800
</td>
<td>
9.541140
</td>
<td>
-24.289522
</td>
<td>
17.189075
</td>
</tr>
<tr>
<th>
50%
</th>
<td>
58.691038
</td>
<td>
16.357689
</td>
<td>
49.562398
</td>
<td>
42.404912
</td>
<td>
118.268178
</td>
<td>
11.767934
</td>
<td>
0.475989
</td>
<td>
21.907150
</td>
<td>
12.938450
</td>
<td>
11.953835
</td>
<td>
-14.622856
</td>
<td>
24.931950
</td>
</tr>
<tr>
<th>
75%
</th>
<td>
72.877696
</td>
<td>
22.120395
</td>
<td>
63.000000
</td>
<td>
52.695888
</td>
<td>
125.467674
</td>
<td>
41.287352
</td>
<td>
0.704846
</td>
<td>
28.954075
</td>
<td>
15.889525
</td>
<td>
14.371810
</td>
<td>
-3.497094
</td>
<td>
33.979600
</td>
</tr>
<tr>
<th>
Max
</th>
<td>
129.834041
</td>
<td>
49.431864
</td>
<td>
125.742385
</td>
<td>
121.429566
</td>
<td>
163.071041
</td>
<td>
418.543082
</td>
<td>
0.998827
</td>
<td>
36.743900
</td>
<td>
19.324000
</td>
<td>
16.821080
</td>
<td>
6.972071
</td>
<td>
44.341200
</td>
</tr>
</tbody>
</table>
</div>
<p>No results seem to be unusual, except for the maximum of the <em>Degree Spondylolisthesis</em>. Usually, a degree is between -180° and 180° (or 0° and 360°). If we look at the other data, it seems that the coding of the angle is between -180° and 180° (with a very few negative angle). Let’s look at all the values out of the usual range of the degrees (it concerns only the variable <em>Degree Spondylolisthesis</em>).</p>
<pre class="python"><code>data[data.degree_spondylolisthesis &gt; 180]</code></pre>
<div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
Pelvic Incidence
</th>
<th>
Pelvic Tilt
</th>
<th>
Lumbar Lordosis Angle
</th>
<th>
Sacral Slope
</th>
<th>
Pelvic Radius
</th>
<th>
Degree Spondylolisthesis
</th>
<th>
Pelvic Slope
</th>
<th>
Direct Tilt
</th>
<th>
Thoracic Slope
</th>
<th>
Cervical Tilt
</th>
<th>
Sacrum Angle
</th>
<th>
Scoliosis Slope
</th>
<th>
Class
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
115
</th>
<td>
129.834041
</td>
<td>
8.404475
</td>
<td>
48.384057
</td>
<td>
121.429566
</td>
<td>
107.690466
</td>
<td>
418.543082
</td>
<td>
0.860223
</td>
<td>
18.5943
</td>
<td>
11.1514
</td>
<td>
11.36543
</td>
<td>
-34.202073
</td>
<td>
27.5144
</td>
<td>
Abnormal
</td>
</tr>
</tbody>
</table>
</div>
<p>Only one observation has a <em>Degree Spondylolisthesis</em> larger than 180. We can consider a typo in the decimal of this value. So, we replace the value 418.543082 by 41.8543082.</p>
<pre class="python"><code>data.loc[115, &#39;degree_spondylolisthesis&#39;] = 41.8543082</code></pre>
<ul>
<li>Recode the variable <em>class</em> into a dummy variable (0: Abnormal, 1: Normal).</li>
</ul>
<pre class="python"><code>data[&#39;class&#39;] = pd.get_dummies(data[&#39;class&#39;], prefix=&#39;class&#39;, drop_first=True)</code></pre>
<ul>
<li>Then, we look at the correlation between the different variables.</li>
</ul>
<pre class="python"><code># Compute the correlation matrix.
corr_data = round(data.corr(),2)</code></pre>
<center>
<img src="output_15_0.png" title="fig:" alt="png" />
</center>
<p>So, it appears that the class {Abnormal, Normal} is negatively correlated with the <em>Pelvic Incidence</em>, the <em>Pelvic Tilt</em>, the <em>Lumbar Lordosis Angle</em>, the <em>Sacral Slope</em> and the <em>Degree Spondylolisthesis</em> and positively correlated with the <em>Pelvic Radius</em>. The class has a very small correlation with the other variables.</p>
<ul>
<li>Let’s look at some boxplot for these variables.</li>
</ul>
<center>
<img src="output_18_0.png" title="fig:" alt="png" />
</center>
</div>
<div id="subset-features-selection" class="section level1">
<h1>Subset features selection</h1>
<pre class="python"><code>model = ExtraTreesClassifier(n_estimators=200, random_state=0)
model.fit(data.drop(&#39;class&#39;, axis=1, inplace=False), data[&#39;class&#39;])

importances = model.feature_importances_
importances_std = np.std([model_tree.feature_importances_ for model_tree in model.estimators_], axis=0)</code></pre>
<center>
<img src="output_21_0.png" title="fig:" alt="png" />
</center>
<p>So, we have an importance score for each attribute where the larger score the more important the attribute. As we see on the correlation plot, the variable <em>degree spondylolisthesis</em> and <em>pelvic radius</em>/<em>pelvic tilt</em>/<em>pelvic incidence</em>/<em>lumbar lordosis angle</em> are strongly correlated. We will consider only the variables <em>Degree Spondylolisthesis</em>, <em>Pelvic Radius</em>, <em>Pelvic Tilt</em> and <em>Pelvic Incidence</em> for building the model (the four with the strongest importance).</p>
<ul>
<li>Let’s plot these variables with the class.</li>
</ul>
<center>
<img src="output_24_0.png" title="fig:" alt="png" />
</center>
</div>
<div id="model-construction" class="section level1">
<h1>Model construction</h1>
<ul>
<li>Split the dataset into train and test set.</li>
</ul>
<pre class="python"><code>X_train, X_test, Y_train, Y_test = train_test_split(data[[&#39;degree_spondylolisthesis&#39;, &#39;pelvic_radius&#39;, &#39;pelvic_tilt&#39;, &#39;pelvic_incidence&#39;]], data[&#39;class&#39;], test_size=1/3, random_state=42)

scaler = StandardScaler().fit(X_train)
X_train_transformed = scaler.transform(X_train)
X_test_transformed = scaler.transform(X_test)</code></pre>
<ul>
<li>Let’s construct the baseline by setting the most frequent response in the training set to compare our model.</li>
</ul>
<pre class="python"><code>dummy = DummyClassifier(strategy=&#39;most_frequent&#39;, random_state=42)
dummy.fit(X_train_transformed, Y_train)
Y_pred_dummy = dummy.predict(X_test_transformed)

Y_pred_proba_dummy = dummy.predict_proba(X_test_transformed)[:, 1]
[fpr_dummy, tpr_dummy, thr_dummy] = metrics.roc_curve(Y_test, Y_pred_proba_dummy)</code></pre>
<blockquote>
<p>The accuracy for the dummy classifier is 72%.</p>
</blockquote>
<ul>
<li>Use the Logistic Regression method to predict the class (by Cross-Validation and GridSearch).</li>
</ul>
<pre class="python"><code>param_log_reg = {&#39;tol&#39;: np.logspace(-5, 1, 7),
                 &#39;C&#39;: np.logspace(-3, 3, 7),
                 &#39;penalty&#39;: [&#39;l2&#39;]}

log_reg = GridSearchCV(LogisticRegression(solver=&#39;lbfgs&#39;), param_log_reg, cv=10, iid=False)
log_reg.fit(X_train_transformed, Y_train)</code></pre>
<blockquote>
<p>Best parameters set found on development set: {‘C’: 1.0, ‘penalty’: ‘l2’, ‘tol’: 1.0}</p>
</blockquote>
<pre class="python"><code>Y_pred_log_reg = log_reg.predict(X_test_transformed)

Y_pred_proba_log_reg = log_reg.predict_proba(X_test_transformed)[:, 1]
[fpr_log_reg, tpr_log_reg, thr_log_reg] = metrics.roc_curve(Y_test, Y_pred_proba_log_reg)</code></pre>
<blockquote>
<p>The accuracy for the Logistic Regression classifier is 85%.</p>
</blockquote>
<ul>
<li>Plot the ROC curves for each models</li>
</ul>
<center>
<img src="output_34_0.png" title="fig:" alt="png" />
</center>
</div>

    </div>

    



<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/python/">Python</a>
  
  <a class="badge badge-light" href="/tags/machine-learning/">Machine Learning</a>
  
  <a class="badge badge-light" href="/tags/logistic-regression/">Logistic Regression</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/project/lower-back-pain/&amp;text=Lower%20Back%20Pain" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/project/lower-back-pain/&amp;t=Lower%20Back%20Pain" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Lower%20Back%20Pain&amp;body=/project/lower-back-pain/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/project/lower-back-pain/&amp;title=Lower%20Back%20Pain" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Lower%20Back%20Pain%20/project/lower-back-pain/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/project/lower-back-pain/&amp;title=Lower%20Back%20Pain" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  






  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="avatar mr-3 avatar-circle" src="/authors/admin/avatar_hucbc2930ba76141ffd5ffb026ad90ced3_85341_270x270_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Steven Golovkine</a></h5>
      <h6 class="card-subtitle">PhD student</h6>
      <p class="card-text">My research interests include functional data analysis, non-parametric statistics and machine learning.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:steven_golovkine@icloud.com" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/steven-golovkine/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/StevenGolovkine" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/project/titanic/">Titanic: Machine Learning from Disaster</a></li>
      
      <li><a href="/post/jupyter-notebook/">Jupyter Notebook</a></li>
      
      <li><a href="/post/library-matplotlib/">Library Matplotlib</a></li>
      
      <li><a href="/post/set-up-python/">Set up Python</a></li>
      
    </ul>
  </div>
  



    <div class="project-related-pages content-widget-hr">
      
      

      
      
      

      
      
      

      
      
      
    </div>
  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/python.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.0630fec5958cb075a5a38f042b3ddde6.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
    
  </p>
  

  <p class="powered-by">
    © 2020 Steven Golovkine. All Rights Reserved &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
